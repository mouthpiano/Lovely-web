<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>地質事件演變模擬器 v15</title>
    
    <!-- 載入 React 和 Babel (讓瀏覽器看懂程式碼) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 載入 Tailwind CSS (美化樣式) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 定義樣式與動畫 -->
    <style>
        body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; }
    </style>
</head>
<body class="bg-stone-50">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useId } = React;

        // --- 圖示組件 ---
        const IconWrapper = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const ArrowRight = ({ className }) => <IconWrapper className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconWrapper>;
        const ArrowLeft = ({ className }) => <IconWrapper className={className}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></IconWrapper>;
        const RefreshCw = ({ className }) => <IconWrapper className={className}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconWrapper>;
        const Layers = ({ className }) => <IconWrapper className={className}><path d="m12.83 2.44 9.8 5.5a.5.5 0 0 1 .27.43v7a.5.5 0 0 1-.25.43l-10.2 6a.5.5 0 0 1-.51 0l-10.2-6a.5.5 0 0 1-.25-.43v-7a.5.5 0 0 1 .27-.43l9.8-5.5a.5.5 0 0 1 .51 0Z"/><path d="m4.93 10.9 6.66 3.92a.5.5 0 0 0 .51 0l6.96-3.97"/><path d="m4.93 15.15 6.66 3.92a.5.5 0 0 0 .51 0l6.96-3.97"/></IconWrapper>;
        const Scissors = ({ className }) => <IconWrapper className={className}><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><line x1="20" x2="8.12" y1="4" y2="15.88"/><line x1="14.47" x2="20" y1="14.48" y2="20"/><line x1="8.12" x2="12" y1="8.12" y2="12"/></IconWrapper>;
        const Activity = ({ className }) => <IconWrapper className={className}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconWrapper>;
        const Mountain = ({ className }) => <IconWrapper className={className}><path d="m8 3 4 8 5-5 5 15H2L8 3z"/></IconWrapper>;
        const Info = ({ className }) => <IconWrapper className={className}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconWrapper>;
        const Home = ({ className }) => <IconWrapper className={className}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></IconWrapper>;
        const Eye = ({ className }) => <IconWrapper className={className}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></IconWrapper>;

        // --- 資料設定區 ---

        const SCENARIOS = {
          STANDARD: 'standard', // 課本模式：岩脈 -> 斷層
          REVERSE: 'reverse',   // 實驗模式：斷層 -> 岩脈
        };

        const STEPS_DATA = [
          {
            id: 0,
            title: "1. 礫岩層沉積",
            desc: "礫石在水底沉積，經過長時間的壓密與膠結，形成了水平且表面平整的礫岩層。",
            principle: "原始水平定律：沉積物在重力作用下傾向於水平堆積。",
            icon: <Layers className="w-6 h-6 text-stone-600" />
          },
          {
            id: 1,
            title: "2. 傾斜與侵蝕",
            desc: "地殼變動使礫岩層傾斜。抬升後表面受到風化侵蝕，原本平整的表面變得凹凸不平（形成不整合面）。",
            principle: "不整合面形成：代表地層沉積中斷、抬升侵蝕的證據。",
            icon: <Mountain className="w-6 h-6 text-amber-700" />
          },
          {
            id: 2,
            title: "3. 砂岩層沉積",
            desc: "地層再次下沉，砂岩沉積在凹凸不平的侵蝕面上，填補了空隙，形成新的水平岩層。",
            principle: "疊置定律：在未受擾動的地層中，下方的岩層比上方的岩層老。",
            icon: <Layers className="w-6 h-6 text-yellow-600" />
          },
          {
            // 步驟 3 (Index 3)
            standard: {
              title: "4. 岩漿入侵 (岩脈)",
              desc: "熾熱岩漿順著裂隙由下而上侵入，貫穿了礫岩與砂岩，並在地表噴發形成三角形的火山錐。",
              principle: "截切定律：被截切者（周圍岩層）較老，截切者（岩脈）較年輕。",
              icon: <Activity className="w-6 h-6 text-red-600" />
            },
            reverse: {
              title: "4. 逆斷層發生 (實驗)",
              desc: "受到擠壓力，斷層發生。依照您的設定，左側的地塊沿著斷層面向上推移。",
              principle: "構造運動：斷層是岩石破裂並沿破裂面發生相對位移的構造。",
              icon: <Scissors className="w-6 h-6 text-purple-600" />
            }
          },
          {
            // 步驟 4 (Index 4)
            standard: {
              title: "5. 逆斷層發生",
              desc: "強大的擠壓力造成逆斷層！左側地塊（包含岩脈）沿著斷層面向上錯動，切斷了原有的岩脈。",
              principle: "截切定律驗證：斷層切過了岩脈，所以斷層比岩脈更晚發生。",
              icon: <Scissors className="w-6 h-6 text-purple-600" />
            },
            reverse: {
              title: "5. 岩漿入侵 (實驗)",
              desc: "斷層發生後，岩漿才入侵。請注意，岩脈頂端完美銜接在已經錯動的砂岩層表面，沒有被切斷。",
              principle: "截切定律驗證：岩脈切過了斷層，所以岩脈比斷層更晚發生。",
              icon: <Activity className="w-6 h-6 text-red-600" />
            }
          },
          {
            id: 5,
            title: "6. 最終侵蝕",
            desc: "長期的風化侵蝕作用將地表突出的部分削平，形成今日凹凸不平的地貌。",
            principle: "侵蝕夷平作用：地表高低起伏被外營力逐漸磨平的過程。",
            icon: <Mountain className="w-6 h-6 text-green-700" />
          }
        ];

        // --- 獨立的地質繪圖組件 (GeologyStage) ---
        const GeologyStage = ({ step, scenario, uniqueId }) => {
          // 視覺參數
          const width = 800;
          const height = 500;
          const sandstoneTopY = 150;
          const erosionY = 280;
          const FAULT_DX = 22;
          const FAULT_DY = -60;

          // 路徑定義
          const wavyCurveData = "C 50,260 150,290 250,270 S 450,290 550,270 C 650,250 750,280 900,260";
          const finalErosionWavyData = "C 50,140 150,170 250,150 S 450,170 550,150 C 650,130 750,160 900,140";

          const skyBlockPath = (isWavy) => {
            const bottomEdge = isWavy 
              ? `M -200,${erosionY} ${wavyCurveData} L 1000,${erosionY}` 
              : `M -200,${erosionY} L 1000,${erosionY}`;                 
            return `${bottomEdge} L 1000,-500 L -200,-500 Z`;
          };

          const sandstonePath = 
            `M -200,${erosionY} ${wavyCurveData} ` + 
            `L 1000,${erosionY - 20} ` +            
            `L 1000,${sandstoneTopY} ` +            
            `L -200,${sandstoneTopY} Z`;

          const getDykePath = (surfaceLevel) => `
            M 380,600 L 410,600 L 410,${surfaceLevel} 
            L 430,${surfaceLevel} 
            L 395,${surfaceLevel - 60} 
            L 360,${surfaceLevel} 
            L 380,${surfaceLevel} 
            Z
          `;

          const faultX_TopRight = 550;
          const faultY_TopRight = -100;
          const faultX_BottomLeft = 250;
          const faultY_BottomLeft = 700;

          const leftBlockClipPath = `
            M ${faultX_BottomLeft},${faultY_BottomLeft} 
            L -200,${faultY_BottomLeft} 
            L -200,${faultY_TopRight} 
            L ${faultX_TopRight},${faultY_TopRight} 
            Z
          `;
          
          const rightBlockClipPath = `
            M ${faultX_BottomLeft},${faultY_BottomLeft} 
            L 1000,${faultY_BottomLeft} 
            L 1000,${faultY_TopRight} 
            L ${faultX_TopRight},${faultY_TopRight} 
            Z
          `;

          // 狀態計算
          const showConglomerate = step >= 0;
          const isTilted = step >= 1;
          const showSandstone = step >= 2;
          const showDyke = scenario === SCENARIOS.STANDARD ? step >= 3 : step >= 4;
          const isFaulted = scenario === SCENARIOS.STANDARD ? step >= 4 : step >= 3;
          const isFinalErosion = step >= 5;

          const conglomerateStyle = {
            transformOrigin: "400px 400px", 
            transform: isTilted ? "rotate(15deg)" : "none",
            transition: "transform 1.5s cubic-bezier(0.4, 0, 0.2, 1)"
          };

          const faultMovementOffset = isFaulted ? `translate(${FAULT_DX}px, ${FAULT_DY}px)` : "translate(0, 0)";
          const finalErosionTranslateY = isFinalErosion ? 40 : -500;

          // ID 生成 (避免多個 SVG 時 ID 衝突)
          const ids = {
            conglomerate: `conglomeratePattern-${uniqueId}`,
            sandstone: `sandstonePattern-${uniqueId}`,
            clipLeft: `clipLeft-${uniqueId}`,
            clipRight: `clipRight-${uniqueId}`,
          };

          return (
            <svg viewBox="0 0 800 500" className="w-full h-full bg-[#e0f2fe]">
              <defs>
                <pattern id={ids.conglomerate} x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                  <rect width="40" height="40" fill="#d6c0a3" />
                  <circle cx="10" cy="10" r="6" fill="#a18e75" opacity="0.8"/>
                  <circle cx="30" cy="30" r="8" fill="#8f7a5e" opacity="0.8"/>
                  <circle cx="25" cy="10" r="4" fill="#b09d82" opacity="0.8"/>
                  <circle cx="10" cy="35" r="3" fill="#b09d82" opacity="0.8"/>
                </pattern>
                <pattern id={ids.sandstone} x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse">
                  <rect width="10" height="10" fill="#fde68a" />
                  <circle cx="2" cy="2" r="1" fill="#d97706" opacity="0.5"/>
                  <circle cx="7" cy="7" r="1" fill="#d97706" opacity="0.5"/>
                </pattern>
                <clipPath id={ids.clipLeft}><path d={leftBlockClipPath} /></clipPath>
                <clipPath id={ids.clipRight}><path d={rightBlockClipPath} /></clipPath>
                <style>
                  {`
                    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                    @keyframes magmaRise { from { transform: translateY(200px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
                  `}
                </style>
              </defs>

              {/* 左側地塊 */}
              <g clipPath={`url(#${ids.clipLeft})`} style={{ transform: faultMovementOffset, transition: "transform 1s cubic-bezier(0.25, 1, 0.5, 1)" }}>
                {/* 礫岩 */}
                {showConglomerate && (
                  <g style={conglomerateStyle}>
                    <rect x="-200" y="100" width="1200" height="800" fill={`url(#${ids.conglomerate})`} stroke="none" />
                  </g>
                )}
                {/* 天空遮罩 */}
                <path d={skyBlockPath(isTilted)} fill="#e0f2fe" stroke="none" style={{ transition: "d 1s ease" }} />
                {/* 砂岩 */}
                {showSandstone && (
                  <g>
                    <path d={sandstonePath} fill={`url(#${ids.sandstone})`} style={{ opacity: 0, animation: "fadeIn 1s forwards" }} stroke="none" />
                    <path d={`M -200,${erosionY} ${wavyCurveData} L 1000,${erosionY - 20}`} fill="none" stroke="#b45309" strokeWidth="1.5" opacity="0.7" />
                  </g>
                )}
                {/* 岩脈 (標準模式左側) */}
                {showDyke && scenario === SCENARIOS.STANDARD && (
                  <path 
                    d={getDykePath(sandstoneTopY)}
                    fill="#ef4444" stroke="#7f1d1d" strokeWidth="2"
                    style={{ opacity: 0, animation: "magmaRise 0.8s ease-out forwards" }}
                  />
                )}
              </g>

              {/* 右側地塊 */}
              <g clipPath={`url(#${ids.clipRight})`}>
                {showConglomerate && (
                  <g style={conglomerateStyle}>
                    <rect x="-200" y="100" width="1200" height="800" fill={`url(#${ids.conglomerate})`} stroke="none" />
                  </g>
                )}
                <path d={skyBlockPath(isTilted)} fill="#e0f2fe" stroke="none" style={{ transition: "d 1s ease" }} />
                {showSandstone && (
                  <g>
                    <path d={sandstonePath} fill={`url(#${ids.sandstone})`} style={{ opacity: 0, animation: "fadeIn 1s forwards" }} stroke="none" />
                    <path d={`M -200,${erosionY} ${wavyCurveData} L 1000,${erosionY - 20}`} fill="none" stroke="#b45309" strokeWidth="1.5" opacity="0.7" />
                  </g>
                )}
                {/* 岩脈 (標準模式右側) */}
                {showDyke && scenario === SCENARIOS.STANDARD && (
                  <path 
                    d={getDykePath(sandstoneTopY)}
                    fill="#ef4444" stroke="#7f1d1d" strokeWidth="2"
                    style={{ opacity: 0, animation: "magmaRise 0.8s ease-out forwards" }}
                  />
                )}
              </g>

              {/* 實驗模式連續岩脈 */}
              {showDyke && scenario === SCENARIOS.REVERSE && (
                <path 
                  d={getDykePath(sandstoneTopY + FAULT_DY)} 
                  fill="#ef4444" stroke="#7f1d1d" strokeWidth="2"
                  style={{ opacity: 0, animation: "magmaRise 0.8s ease-out forwards" }}
                />
              )}

              {/* 斷層線 */}
              {isFaulted && (
                <line 
                  x1={faultX_TopRight} y1={faultY_TopRight} 
                  x2={faultX_BottomLeft} y2={faultY_BottomLeft} 
                  stroke="#1e293b" strokeWidth="2" strokeDasharray="8,4" opacity="0.4" 
                />
              )}

              {/* 最終侵蝕層 */}
              <g style={{ transform: `translateY(${finalErosionTranslateY}px)`, transition: "transform 1.5s ease-in-out" }}>
                <path d={`M -200,${sandstoneTopY} ${finalErosionWavyData} L 1000,${sandstoneTopY} L 1000,-600 L -200,-600 Z`} fill="#e0f2fe" stroke="none" />
                <path d={`M -200,${sandstoneTopY} ${finalErosionWavyData} L 1000,${sandstoneTopY}`} fill="none" stroke="#10b981" strokeWidth="3" opacity={isFinalErosion ? 0.3 : 0} strokeDasharray="4,4" />
              </g>
            </svg>
          );
        };

        // --- 主組件 ---

        const GeologySimV15 = () => {
          const [mode, setMode] = useState('intro'); // 'intro' 或 'sim'
          const [step, setStep] = useState(0);
          const [scenario, setScenario] = useState(SCENARIOS.STANDARD);
          const [isAutoPlaying, setIsAutoPlaying] = useState(false);

          // 自動播放
          useEffect(() => {
            let interval;
            if (isAutoPlaying && mode === 'sim') {
              interval = setInterval(() => {
                setStep((prev) => {
                  if (prev < 5) return prev + 1;
                  setIsAutoPlaying(false);
                  return prev;
                });
              }, 2500);
            }
            return () => clearInterval(interval);
          }, [isAutoPlaying, mode]);

          // 取得當前步驟的文字資料
          const currentData = STEPS_DATA[step][scenario] || STEPS_DATA[step];

          // 切換情境 (在模擬模式中)
          const toggleScenario = () => {
            setScenario(prev => prev === SCENARIOS.STANDARD ? SCENARIOS.REVERSE : SCENARIOS.STANDARD);
            setStep(0);
            setIsAutoPlaying(false);
          };

          // 開始模擬
          const startSim = (targetScenario) => {
            setScenario(targetScenario);
            setStep(0);
            setIsAutoPlaying(false);
            setMode('sim');
          };

          // 回到首頁
          const goHome = () => {
            setMode('intro');
            setIsAutoPlaying(false);
          };

          // --- 首頁 (Intro Screen) ---
          if (mode === 'intro') {
            return (
              <div className="flex flex-col items-center min-h-screen bg-slate-50 p-8 font-sans">
                <div className="max-w-6xl w-full">
                  <header className="text-center mb-10">
                    <h1 className="text-4xl font-bold text-slate-800 mb-3 flex items-center justify-center gap-3">
                      <Mountain className="w-10 h-10 text-blue-600" />
                      地質事件偵探：誰先誰後？
                    </h1>
                    {/* 保留此段文字 */}
                    <p className="text-slate-600 text-lg">觀察下方的地層剖面，試著判斷「斷層」與「岩脈」發生的先後順序。</p>
                  </header>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                    {/* 標準模式預覽 */}
                    <div className="bg-white rounded-2xl shadow-lg overflow-hidden border-2 border-blue-100 hover:border-blue-400 transition-all group">
                      <div className="bg-blue-50 p-4 border-b border-blue-100 flex justify-between items-center">
                        <h2 className="text-xl font-bold text-blue-800">情境 A</h2>
                        <span className="px-3 py-1 bg-white text-blue-600 rounded-full text-sm font-bold shadow-sm">課本案例</span>
                      </div>
                      <div className="aspect-video bg-blue-50 p-4">
                        <div className="w-full h-full rounded-lg overflow-hidden shadow-inner bg-white">
                          {/* 顯示最終步驟 (step=5) */}
                          <GeologyStage step={5} scenario={SCENARIOS.STANDARD} uniqueId="preview-std" />
                        </div>
                      </div>
                      <div className="p-6 text-center">
                        {/* 刪除說明文字 */}
                        <button 
                          onClick={() => startSim(SCENARIOS.STANDARD)}
                          className="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-full font-bold hover:bg-blue-700 transition-colors shadow-md group-hover:scale-105 transform duration-200"
                        >
                          <Eye className="w-5 h-5" />
                          進入模擬與解析
                        </button>
                      </div>
                    </div>

                    {/* 實驗模式預覽 */}
                    <div className="bg-white rounded-2xl shadow-lg overflow-hidden border-2 border-purple-100 hover:border-purple-400 transition-all group">
                      <div className="bg-purple-50 p-4 border-b border-purple-100 flex justify-between items-center">
                        <h2 className="text-xl font-bold text-purple-800">情境 B</h2>
                        <span className="px-3 py-1 bg-white text-purple-600 rounded-full text-sm font-bold shadow-sm">假設實驗</span>
                      </div>
                      <div className="aspect-video bg-purple-50 p-4">
                        <div className="w-full h-full rounded-lg overflow-hidden shadow-inner bg-white">
                          {/* 顯示最終步驟 (step=5) */}
                          <GeologyStage step={5} scenario={SCENARIOS.REVERSE} uniqueId="preview-rev" />
                        </div>
                      </div>
                      <div className="p-6 text-center">
                        {/* 刪除說明文字 */}
                        <button 
                          onClick={() => startSim(SCENARIOS.REVERSE)}
                          className="inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-full font-bold hover:bg-purple-700 transition-colors shadow-md group-hover:scale-105 transform duration-200"
                        >
                          <Eye className="w-5 h-5" />
                          進入模擬與解析
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // --- 模擬模式 (Sim Screen) ---
          return (
            <div className="flex flex-col items-center min-h-screen bg-stone-50 font-sans text-slate-800 p-4 pb-12">
              {/* 標題列 */}
              <header className="w-full max-w-5xl mb-6 flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-xl shadow-sm border-b-4 border-blue-500">
                <div className="flex items-center gap-3">
                  <button onClick={goHome} className="p-2 hover:bg-slate-100 rounded-full transition-colors" title="回首頁">
                    <Home className="text-slate-600 w-6 h-6" />
                  </button>
                  <div className="bg-blue-100 p-2 rounded-lg">
                    <Layers className="text-blue-600 w-6 h-6" />
                  </div>
                  <div>
                    <h1 className="text-xl font-bold text-slate-800">互動地質實驗室</h1>
                    <p className="text-xs text-slate-500">模擬地質事件的先後順序與構造特徵</p>
                  </div>
                </div>
                
                <div className="flex gap-2 mt-4 md:mt-0 bg-slate-100 p-1 rounded-lg">
                  <button
                    onClick={() => { setScenario(SCENARIOS.STANDARD); setStep(0); }}
                    className={`px-4 py-2 rounded-md text-sm font-bold transition-all ${scenario === SCENARIOS.STANDARD ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                  >
                    情境 A (標準)
                  </button>
                  <button
                    onClick={() => { setScenario(SCENARIOS.REVERSE); setStep(0); }}
                    className={`px-4 py-2 rounded-md text-sm font-bold transition-all ${scenario === SCENARIOS.REVERSE ? 'bg-white text-purple-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}
                  >
                    情境 B (實驗)
                  </button>
                </div>
              </header>

              {/* 主視窗區域 */}
              <main className="relative w-full max-w-5xl aspect-[16/9] bg-blue-50 rounded-2xl overflow-hidden border-4 border-slate-200 shadow-inner mb-6 group">
                
                {/* 呼叫獨立的繪圖組件 */}
                <GeologyStage step={step} scenario={scenario} uniqueId="main-sim" />

                {/* 步驟指示器 */}
                <div className="absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg shadow-sm border border-slate-200">
                   <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">Current Step</span>
                   <div className="text-2xl font-bold text-blue-600">{step + 1} <span className="text-lg text-slate-400 font-normal">/ 6</span></div>
                </div>
              </main>

              {/* 控制與解說區 */}
              <div className="w-full max-w-5xl grid grid-cols-1 md:grid-cols-12 gap-6">
                
                {/* 左側控制盤 */}
                <div className="md:col-span-4 bg-white rounded-xl p-6 shadow-sm border border-slate-100 flex flex-col gap-4">
                  <div className="flex items-center justify-between gap-2 mb-2">
                     <button 
                       onClick={() => { setIsAutoPlaying(false); setStep(Math.max(0, step - 1)); }}
                       disabled={step === 0}
                       className="flex-1 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg py-3 flex justify-center transition-colors disabled:opacity-50"
                     >
                       <ArrowLeft className="w-5 h-5" />
                     </button>
                     <button 
                       onClick={() => { setIsAutoPlaying(false); setStep(Math.min(5, step + 1)); }}
                       disabled={step === 5}
                       className="flex-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg py-3 flex justify-center transition-colors disabled:opacity-50 shadow-md shadow-blue-200"
                     >
                       <ArrowRight className="w-5 h-5" />
                     </button>
                  </div>
                  
                  <button 
                    onClick={() => setIsAutoPlaying(!isAutoPlaying)}
                    className={`w-full py-3 rounded-lg font-bold text-sm transition-colors flex items-center justify-center gap-2 ${isAutoPlaying ? 'bg-red-50 text-red-600 border border-red-100' : 'bg-slate-50 text-slate-600 hover:bg-slate-100 border border-slate-200'}`}
                  >
                    {isAutoPlaying ? '❚❚ 暫停播放' : '▶ 自動播放演示'}
                  </button>
                  
                  <button onClick={() => {setStep(0); setIsAutoPlaying(false);}} className="text-slate-400 text-xs hover:text-slate-600 flex items-center justify-center gap-1 mt-2">
                    <RefreshCw className="w-3 h-3" /> 重置模擬
                  </button>

                  <div className="mt-auto pt-6 border-t border-slate-100">
                    <div className="flex items-start gap-3">
                      <Info className="w-5 h-5 text-blue-500 shrink-0 mt-0.5" />
                      <div className="text-xs text-slate-500 leading-relaxed">
                        <strong className="block text-slate-700 mb-1">觀察重點：</strong>
                        {scenario === SCENARIOS.STANDARD ? (
                          <span>注意看 <span className="text-red-500 font-bold">紅色岩脈</span>，它被斷層切斷並錯開了。這證明岩脈比斷層<span className="underline decoration-wavy decoration-blue-300">更早形成</span>。</span>
                        ) : (
                          <span>注意看 <span className="text-red-500 font-bold">紅色岩脈</span>，它完整地穿過了已經錯動的地層。這證明<span className="underline decoration-wavy decoration-purple-300">斷層比岩脈入侵更早發生</span>。</span>
                        )}
                      </div>
                    </div>
                  </div>
                </div>

                {/* 右側解說卡 (8 cols) */}
                <div className="md:col-span-8 bg-white rounded-xl p-8 shadow-sm border-t-4 border-amber-400 relative overflow-hidden">
                   <div className="absolute top-0 right-0 p-4 opacity-10">
                     {currentData.icon}
                   </div>
                   
                   <div className="flex flex-col h-full justify-center">
                     <div className="flex items-center gap-3 mb-4">
                       <span className="p-2 bg-amber-100 text-amber-700 rounded-lg">
                         {currentData.icon}
                       </span>
                       <h2 className="text-2xl font-bold text-slate-800">{currentData.title}</h2>
                     </div>
                     
                     <p className="text-slate-600 text-lg leading-relaxed mb-6">
                       {currentData.desc}
                     </p>
                     
                     <div className="bg-slate-50 rounded-lg p-4 border-l-4 border-slate-400">
                       <span className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1 block">Geological Principle</span>
                       <p className="text-slate-800 font-medium text-lg">{currentData.principle}</p>
                     </div>
                   </div>
                </div>

              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<GeologySimV15 />);
    </script>
</body>
</html>